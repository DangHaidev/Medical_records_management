@model Medical_record.Application.DTOs.AppointmentVM
@{
    ViewData["Title"] = "Appointment";
    // string cccd = @User.FindFirst(System.Security.Claims.ClaimTypes.Name)?.Value;
}


<!-- Appointment Start -->
<div class="container-xxl py-5">
    <div class="container">
        <div class="row g-5">
            <div class="col-lg-6 wow fadeInUp" data-wow-delay="0.1s">
                <p class="d-inline-block border rounded-pill py-1 px-4">Appointment</p>
                <h1 class="mb-4">Make An Appointment To Visit Our Doctor</h1>
                <p class="mb-4">Tempor erat elitr rebum at clita. Diam dolor diam ipsum sit. Aliqu diam amet diam et eos. Clita erat ipsum et lorem et sit, sed stet lorem sit clita duo justo magna dolore erat amet</p>
                <div class="bg-light rounded d-flex align-items-center p-5 mb-4">
                    <div class="d-flex flex-shrink-0 align-items-center justify-content-center rounded-circle bg-white" style="width: 55px; height: 55px;">
                        <i class="fa fa-phone-alt text-primary"></i>
                    </div>
                    <div class="ms-4">
                        <p class="mb-2">Call Us Now</p>
                        <h5 class="mb-0">+012 345 6789</h5>
                    </div>
                </div>
                <div class="bg-light rounded d-flex align-items-center p-5">
                    <div class="d-flex flex-shrink-0 align-items-center justify-content-center rounded-circle bg-white" style="width: 55px; height: 55px;">
                        <i class="fa fa-envelope-open text-primary"></i>
                    </div>
                    <div class="ms-4">
                        <p class="mb-2">Mail Us Now</p>
                        <h5 class="mb-0">info@example.com</h5>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 wow fadeInUp" data-wow-delay="0.5s">
                <div class="bg-light rounded h-100 d-flex align-items-center p-5">
                    <form asp-controller="Appointment" asp-area="Client" asp-action="Appointment" method="post">
                        <div class="row g-3">
                            <div class="col-12 col-sm-6">
                                <input value="@ViewBag?.patient.Name" type="text" class="form-control border-0" placeholder="Your Name" style="height: 55px;">
                            </div>
                            <div class="col-12 col-sm-6">
                                <input  type="email" class="form-control border-0" asp-for="Email" placeholder="Your Email" style="height: 55px;" required>
                                <span asp-validation-for="Email" class="text-danger"></span>

                            </div>
                            <div class="col-12 col-sm-6">
                                <input type="text" class="form-control border-0" value="@ViewBag?.patient.Phone" placeholder="Your Mobile" style="height: 55px;">
                            </div>
                            <div class="col-12 col-sm-6">
                                <select asp-for="EmployeeId" class="form-select border-0" style="height: 55px;" required>
                                    <option >Choose Doctor</option>

                                    @foreach (var item in ViewBag.ListDoctors)
                                    {
                                        <option value="@item.EmployeeId">@item.Name</option>
                                    }

                                </select>
                            </div>
                            <div class="col-12 col-sm-6">
                                <div  data-target-input="nearest">
                                    <input type="date" asp-for="AppointmentDate" id="AppointmentDate"
                                           class="form-control border-0 datetimepicker-input"
                                           placeholder="Choose Date" data-target="#date" data-toggle="datetimepicker" style="height: 55px;" min="" required>
                                    <span asp-validation-for="AppointmentDate" class="text-danger"></span>

                                </div>
                            </div>
                            <div class="col-12 col-sm-6">
                                <div class="time" id="time" data-target-input="nearest">
                                    <input type="text" asp-for="AppointmentTime" id="AppointmentTime"
                                           class="form-control border-0 datetimepicker-input"
                                           placeholder="Choose Date" data-target="#time" data-toggle="datetimepicker" style="height: 55px;"  required>                                   
                                </div>
                            </div>
                            <span id="dateTimeError" style="color:red"></span>
                            <div class="col-12">
                                <textarea asp-for="AppointmentDescription" class="form-control border-0" rows="5" placeholder="Describe your problem"></textarea>
                            </div>
                            <input type="hidden" asp-for="cccd" value="@User.FindFirst(System.Security.Claims.ClaimTypes.Name)?.Value" />
                            <div class="col-12">
                                <button class="btn btn-primary w-100 py-3" type="submit">Book Appointment</button>
                            </div>
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Appointment End -->

@section Scripts
{
<script>

    window.onload = function () {
        // Set min date = ngày mai
        const dateInput = document.getElementById('AppointmentDate');
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(today.getDate() + 1);

        // Format YYYY-MM-DD
        const yyyy = tomorrow.getFullYear();
        const mm = (tomorrow.getMonth() + 1).toString().padStart(2, '0');
        const dd = tomorrow.getDate().toString().padStart(2, '0');
        const minDateStr = `${yyyy}-${mm}-${dd}`;
        dateInput.min = minDateStr;
        dateInput.value = minDateStr; // Mặc định chọn ngày mai

        // Thời gian thì đã set min/max trong HTML rồi  
            $('#time').datetimepicker({
                format: 'HH:mm',
                stepping: 15,
                enabledHours: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
                useCurrent: false
            });
    };
</script>
}